 {% extends 'layout_common.html' %}
{% load static %}
{% block body_block %}

 <!-- Candidates Details -->
    <div class="alice-bg padding-top-60 section-padding-bottom">
      <div class="container">
        <div class="row">
          <div class="col">
            <div class="candidate-details">
              <div class="title-and-info">
                <div class="title">
                  <div class="thumb" id="pro_pic">
<!--                    <img src="images/candidate/thumb-1.jpg" class="img-fluid" alt="">-->
                  </div>
                  <div class="title-body">
                    <h4 id="uName"></h4>
                    <div class="info">
                      <span class="candidate-designation"><i data-feather="check-square"></i> </span>
                      <span class="candidate-location" ><i data-feather="map-pin"></i> </span>
                    </div>
                  </div>
                </div>
<!--                <div class="download-resume">-->
<!--                  <a href="#">Download CV <i data-feather="download"></i></a>-->
<!--                </div>-->
              </div>
              <div class="skill-and-profile">
                <div class="skill">
                  <label>Skills:</label>
<!--                  <a href="#">Design</a>-->
<!--                  <a href="#">Illustration</a>-->
<!--                  <a href="#">iOS</a>-->
                </div>
                <div class="social-profile">
                  <label>Social:</label>
                  <a href="#" class="facebook"><i class="fab fa-facebook-f"></i></a>
                  <a href="#" class="twitter"><i class="fab fa-twitter"></i></a>
                  <a href="#" class="linkedin"><i class="fab fa-linkedin-in"></i></a>

                </div>
              </div>
              <div class="details-information section-padding-60">
                <div class="row">
                  <div class="col-xl-7 col-lg-8">
                    <div class="about-details details-section" >
                      <h4><i data-feather="align-left"></i>About Me</h4>
                       <div id="pro_about">

                       </div>
                    </div>


                    <div class="edication-background details-section" id="edu">
                      <h4><i data-feather="book"></i>Education Background</h4>




                    </div>



                    <div class="experience details-section" id="work">
                      <h4><i data-feather="briefcase"></i>Work Experiance</h4>



                    </div>



                    <div class="professonal-skill details-section">
                      <h4><i data-feather="feather"></i>Professional Skill</h4>
                      <div class="progress-group" id="pro_skill">

                      </div>
                    </div> <br/><br/><br/><br/>












<!--       view profile certification_info-->



                     <div class="edication-background details-section" id="cft">
                      <h4><i data-feather="check-circle"></i>Certification</h4>

                    </div>





<!--       view profile membership_info-->



                     <div class="edication-background details-section" id="mbr">
                      <h4><i data-feather="user-check"></i>Membership</h4>

                    </div>
                  </div>

                  <div class="col-xl-4 offset-xl-1 col-lg-4">
                    <div class="information-and-contact">
                      <div class="information">
                        <h4>Information</h4>
                        <ul>
                          <li id="cat"><span>Category:</span>  </li>
                          <li id="loc"><span>Location:</span>  </li>
                          <li id="sts"><span>Status:</span>  </li>
                          <li id="exp"><span>Experience:</span>  </li>
                          <li id="sry"><span>Salary:</span> </li>
                          <li id="gen"><span>Gender:</span>  </li>
                          <li id="age"><span>Age:</span> </li>
                          <li id="qua"><span>Qualification:</span>  </li>
                        </ul>
                      </div>


                    </div>
                  </div>
                </div>
              </div>
              <div class="row">
                <div class="col-xl-7 col-lg-8">
                  <div class="personal-information details-section">
                    <h4><i data-feather="user-plus"></i>Personal Deatils</h4>
                    <ul>
                      <li id="u_name"><span>Full Name:</span>  </li>
                      <li id="f_name"><span>Father's Name:</span>  </li>
                      <li id="m_name"><span>Mother's Name:</span>  </li>
                      <li id="dob"><span>Date of Birth:</span>  </li>
                      <li id="nality"><span>Nationality:</span>   </li>
                      <li id="sex"><span>Sex:</span>  </li>
                      <li id="add"><span>Address:</span>  </li>
                    </ul>
                  </div>
                </div>
              </div>
            </div>
          </div>
        </div>
      </div>
    </div>
    <!-- Candidates Details End -->

 {% endblock %}


 {% block extra_js %}
    <script>
        $(document).ready(function() {

            var path = window.location.pathname.split('/');
            var id = path[path.length-2];

            var getUrl = '/api/professional/profile/'+ id + '/';
            get(getUrl, loadProfile);

            initAjaxForms();

        });

            function loadProfile(data){
 //console.log('data' , data)

 //professional view profile picture, designation and location

            $('#uName').append(data.personal_info.full_name);
            if(data.personal_info.image){
                $('#pro_pic').append('<img src="'+ data.personal_info.image +'" class="img-fluid" alt="">');
            }
            else{
                $('#pro_pic').append('<img src="/static/images/alternate.jpg" class="img-fluid" alt="">');
            }
            if(data.personal_info.current_designation){
                $('.candidate-designation').append(data.personal_info.current_designation);
            }
            else{
               $('.candidate-designation').append('Unknown');
            }
            if(data.personal_info.current_location){
                 $('.candidate-location').append(data.personal_info.current_location);
            }
            else{
                $('.candidate-location').append('Unknown');
            }


 //professional view profile skill and social

            skill_info = data['skill_info']
            len = skill_info.length;
            for(x=0;x<len;x++){
                $('.skill').append('<a href="#">'+skill_info[x].skill_obj.name+'</a>');
            }

            if(data.personal_info.facebook_id){
                   facebook = 'http://facebook.com/'+data.personal_info.facebook_id;
            }
            else{
                   facebook = '#';
            }
            if(data.personal_info.twitter_id){
                   twitter  = 'http://twitter.com/'+data.personal_info.twitter_id;
            }
            else{
                   twitter  = '#';
            }
            if(data.personal_info.linkedin_id){
                   linkedin = 'http://linkedin.com/'+data.personal_info.linkedin_id;
            }
            else{
                  linkedin = '#';
            }
            $('.facebook').attr('href',facebook);
            $('.twitter').attr('href',twitter);
            $('.linkedin').attr('href', linkedin);


 //professional view profile about

            if(data.personal_info.about_me){
                    var about_html='<p>'+data.personal_info.about_me+'</p>';
            }
            else{
                 var about_html='<p></p>';
            }
            $("#pro_about").html(about_html);

            function getAge(dateString)
            {
                var today = new Date();
                var birthDate = new Date(dateString);
                var age = today.getFullYear() - birthDate.getFullYear();
                var m = today.getMonth() - birthDate.getMonth();
                if (m < 0 || (m === 0 && today.getDate() < birthDate.getDate()))
                {
                    age--;
                }
                return age;
            }

            if(data.personal_info.industry_expertise){
                 $('#cat').append(data.personal_info.industry_expertise);
            }
            else{
                $('#cat').append('');
            }
              if(data.personal_info.address){
                 $('#loc').append(data.personal_info.address);
            }
            else{
                $('#loc').append('');
            }
            if(data.personal_info.status){
                 $('#sts').append(data.personal_info.status);
            }
            else{
                $('#sts').append('');
            }
            if(data.personal_info.experience){

                 $('#exp').append(data.personal_info.experience + ' Year(s)');
            }
            else{
                $('#exp').append('');
            }
            if(data.personal_info.expected_salary_min){
                 $('#sry').append(data.personal_info.expected_salary_min);
            }
            else{
                $('#sry').append('');
            }
            if(data.personal_info.expected_salary_max){
                 $('#sry').append(' - ' + data.personal_info.expected_salary_max);
            }
            else{
                $('#sry').append('');
            }
            if(data.personal_info.gender){
                 $('#gen').append(data.personal_info.gender);
            }
            else{
                $('#gen').append('');
            }
            if(data.personal_info.date_of_birth){
                 var pro_age = getAge(data.personal_info.date_of_birth)
                 $('#age').append(pro_age + ' Year(s)');
            }
            else{
                $('#age').append('');
            }
            if(data.personal_info.qualification){
                 $('#qua').append(data.personal_info.qualification);
            }
            else{
                $('#qua').append('');
            }


 //view profile Education Background

            edu_data = data['edu_info']
 //console.log('edu_data' , edu_data)
            len = edu_data.length;
            for(x=0;x<len;x++){

                    if(edu_data[x].enrolled_date){
                             var enrolled_date = edu_data[x].enrolled_date;
                             var momentObj = moment(enrolled_date, 'YYYY-MM-DD');
                             var dateMomentString = momentObj.format('DD-MM-YYYY');
                             var enrolled_date = momentObj.format('YYYY');    ;
                    }
                    else{
                         enrolled_date = '';
                    }
                    if(edu_data[x].is_ongoing == true){
                             var graduation_date = 'Present';
                    }
                    else if(edu_data[x].graduation_date){

                             var graduation_date = edu_data[x].graduation_date;
                             var momentObj = moment(graduation_date, 'YYYY-MM-DD');
                             var dateMomentString = momentObj.format('DD-MM-YYYY');
                             var graduation_date = momentObj.format('YYYY');
                    }
                    else{
                           var graduation_date = '';
                        }
                    if(edu_data[x].degree){
                            var degree = edu_data[x].degree;
                    }
                    else{
                            var degree =  '';
                    }
                    if(edu_data[x].institution_obj.name){
                         var institution_obj = edu_data[x].institution_obj.name;
                    }
                    else{
                         var institution_obj = '';
                    }
                    if(edu_data[x].institution_text){
                         var institution_text =  edu_data[x].institution_text;
                    }
                    else{
                         var institution_text = '';
                    }
                    if(edu_data[x].major_obj.name){
                        var major_obj = edu_data[x].major_obj.name;
                    }
                    else{
                        var major_obj = '';
                    }
                    if(edu_data[x].cgpa){
                        var cgpa = edu_data[x].cgpa;
                    }
                    else{
                        var cgpa = '';
                    }
                    if(edu_data[x].major_text){
                        var major_text = edu_data[x].major_text;
                    }
                    else{
                        var major_text = '';
                    }
                var edu_html='<div class="education-label">'+
                    '<span class="study-year">'+enrolled_date+' - '+graduation_date+'</span>'+
                    '<h5>'+degree+'<span>@ ' +institution_obj+'</span></h5>'+
                    '<p>'+institution_text+'</p>'+
                    '<p><b>'+major_obj+'</b> - '+cgpa+'</p>'+
                    '<p>'+major_text+'</p>'+
                    '</div><br>';
                $('#edu').append(edu_html);
            }


 //view profile Work Experiance

            experience_info = data['experience_info']
 //console.log('experience_info' , experience_info)
            len = experience_info.length;
            for(x=0;x<len;x++){

                    if(experience_info[x].start_date){
                             var start_date = experience_info[x].start_date;
                             var momentObj = moment(start_date, 'YYYY-MM-DD');
                             var dateMomentString = momentObj.format('DD-MM-YYYY');
                             var start_date = momentObj.format('YYYY');    ;
                    }
                    else{
                         start_date = '';
                    }
                    if(experience_info[x].end_date){

                             var end_date = experience_info[x].end_date;
                             var momentObj = moment(end_date, 'YYYY-MM-DD');
                             var dateMomentString = momentObj.format('DD-MM-YYYY');
                             var end_date = momentObj.format('YYYY');
                    }
                    else{
                          if(experience_info[x].start_date){
                              var end_date = 'Present';
                          }
                          else{
                           var end_date = '';
                           }
                        }
                    if(experience_info[x].designation){
                            var designation = experience_info[x].designation;
                    }
                    else{
                            var designation =  '';
                    }
                    if(experience_info[x].company){
                         var company = experience_info[x].company;
                    }
                    else{
                         var company = '';
                    }
                    if(experience_info[x].company_text){
                         var company_text =  experience_info[x].company_text;
                    }
                    else{
                         var company_text = '';
                    }
                var work_html='<div class="experience-section">'+
                    '<span class="service-year">'+start_date+' - '+end_date+'</span>'+
                    '<h5>'+designation+'<span>@ ' +company+'</span></h5>'+
                    '<p>'+company_text+'</p>'+
                    '</div><br>';
                $('#work').append(work_html);
            }



 //view profile skill rating

            pro_skill_data = data['skill_info']
            len = pro_skill_data.length;
            for(x=0;x<len;x++){
                var pro_skill_html='<div class="progress-item">'+
                    '<div class="progress-head">'+
                    '<p class="progress-on">'+pro_skill_data[x].skill_obj.name+'</p>'+
                    '</div>'+
                    '<div class="progress-body">'+
                    '<div class="progress">'+
                    '<div class="progress-bar" role="progressbar" aria-valuenow="'+pro_skill_data[x].rating*10+'" aria-valuemin="0" aria-valuemax="10" style="width: 0;"></div>'+
                    '</div>'+
                    '<p class="progress-to">'+pro_skill_data[x].rating+'/10</p>'+
                    '</div>'+
                    '</div>';

                $('#pro_skill').append(pro_skill_html);
            }



 //view profile certification_info

            certification_info = data['certification_info']
 //console.log('certification_info' , certification_info)
            len = certification_info.length;
            for(x=0;x<len;x++){

                    if(certification_info[x].issue_date){
                             var issue_date = certification_info[x].issue_date;
                             var momentObj = moment(issue_date, 'YYYY-MM-DD');
                             var dateMomentString = momentObj.format('DD-MM-YYYY');
                             var issue_date = momentObj.format('YYYY');    ;
                    }
                    else{
                         issue_date = '';
                    }
                    if(certification_info[x].expiry_date){

                             var expiry_date = certification_info[x].expiry_date;
                             var momentObj = moment(expiry_date, 'YYYY-MM-DD');
                             var dateMomentString = momentObj.format('DD-MM-YYYY');
                             var expiry_date = momentObj.format('YYYY');
                    }
                    else{
                          if(certification_info[x].has_expiry_period == false){
                              var expiry_date = 'Lifetime Certification';
                          }
                          else{
                           var expiry_date = '';
                           }
                        }
                    if(certification_info[x].certificate_name){
                            var certificate_name = certification_info[x].certificate_name;
                    }
                    else{
                            var certificate_name =  '';
                    }
                    if(certification_info[x].credential_id){
                         var credential_id = certification_info[x].credential_id;
                    }
                    else{
                         var credential_id = '';
                    }
                    if(certification_info[x].credential_url){
                         var credential_url = certification_info[x].credential_url;
                    }
                    else{
                         var credential_url = '';
                    }
                    if(certification_info[x].organization){
                         var organization =  certification_info[x].organization;
                    }
                    else{
                         var organization = '';
                    }

                   var cft_html='<div class="education-label">'+
                    '<span class="study-year">'+issue_date+' - '+expiry_date+'</span>'+
                    '<h5>'+certificate_name+'<span> @ ' +organization+'</span></h5>'+
                    '<p><b>'+credential_id+'</b> - <a style="color:blue;" href="'+credential_url+'">view</a></p>'+
                    '</div><br>';
                $('#cft').append(cft_html);
            }



 //view profile membership_info

            membership_info = data['membership_info']
 //console.log('membership_info' , membership_info)
            len = membership_info.length;
            for(x=0;x<len;x++){

                    if(membership_info[x].start_date){
                             var start_date = membership_info[x].start_date;
                             var momentObj = moment(start_date, 'YYYY-MM-DD');
                             var dateMomentString = momentObj.format('DD-MM-YYYY');
                             var start_date = momentObj.format('YYYY');    ;
                    }
                    else{
                         start_date = '';
                    }
                    if(membership_info[x].end_date){

                             var end_date = membership_info[x].end_date;
                             var momentObj = moment(end_date, 'YYYY-MM-DD');
                             var dateMomentString = momentObj.format('DD-MM-YYYY');
                             var end_date = momentObj.format('YYYY');
                    }
                    else{
                          if(membership_info[x].membership_ongoing == true){
                              var end_date = 'Present';
                          }
                          else{
                           var end_date = '';
                           }
                        }
                    if(membership_info[x].organization){
                            var organization = membership_info[x].organization;
                    }
                    else{
                            var organization =  '';
                    }
                    if(membership_info[x].position_held){
                         var position_held = membership_info[x].position_held;
                    }
                    else{
                         var position_held = '';
                    }
                    if(membership_info[x].description){
                         var description = membership_info[x].description;
                    }
                    else{
                         var description = '';
                    }


            var mbr_html='<div class="education-label">'+
                '<span class="study-year">'+start_date+' - '+end_date+'</span>'+
                '<h5>'+position_held+'<span> @ ' +organization+'</span></h5>'+
                '<p>'+description+'</p>'+
                '</div><br>';
            $('#mbr').append(mbr_html);
            }


 //view profile personal deatils

            if(data.personal_info.full_name){
                 $('#u_name').append(data.personal_info.full_name);
            }
            else{
                $('#u_name').append('');
            }

              if(data.personal_info.father_name){
                 $('#f_name').append(data.personal_info.father_name);
            }
            else{
                $('#f_name').append('');
            }
            if(data.personal_info.mother_name){
                 $('#m_name').append(data.personal_info.mother_name);
            }
            else{
                $('#m_name').append('');
            }
            if(data.personal_info.date_of_birth){
                 var dateofbirth = data.personal_info.date_of_birth
                 var momentObj = moment(dateofbirth, 'YYYY-MM-DD');
                 var dateMomentString = momentObj.format('DD-MM-YYYY');
                 $('#dob').append(dateMomentString);
            }
            else{
                $('#dob').append('');
            }
            if(data.personal_info.nationality_obj.name){
                 $('#nality').append(data.personal_info.nationality_obj.name);
            }
            else{
                $('#nality').append('');
            }
            if(data.personal_info.gender){
                 $('#sex').append(data.personal_info.gender);
            }
            else{
                $('#sex').append('');
            }
            if(data.personal_info.permanent_address){
                 $('#add').append(data.personal_info.permanent_address);
            }
            else{
                $('#add').append('');
            }


        }


    </script>
{% endblock %}